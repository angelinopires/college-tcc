<div class="main-content dashboard">
    <div class="dashboard__header">
        <button class="dashboard__button">
            <p>+</p>
        </button>
    </div>

    <!--
    <form class="row">
        <div class="col-12 col-md-9">
            <mat-form-field appearance="outline">
                <mat-label>Código</mat-label>
                <input matInput placeholder="Busque pela solicitação desejada">
            </mat-form-field>
        </div>
        <div class="col-12 col-md-3">
            <button mat-raised-button type="submit" class="btn btn-primary btn-block btn-round">Pesquisar</button>
        </div>
    </form> -->

    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header card-header-info">
                    <h4 class="card-title">Solicitações de Compra</h4>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <mat-table class="table table-responsive table-full-width" [dataSource]="requestsList" matSort
                            multiTemplateDataRows>
                            <ng-container matColumnDef="id">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
                                <td class="table__cell" mat-cell *matCellDef="let element"> {{ element.id }} </td>
                            </ng-container>

                            <ng-container matColumnDef="requesterName">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header> Solicitante </th>
                                <td class="table__cell" mat-cell *matCellDef="let element"> {{ element.requester.name }}
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="justification">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header> Observação </th>
                                <td class="table__cell table__cell--overflow" mat-cell *matCellDef="let element">
                                    {{ element.justification }} </td>
                            </ng-container>

                            <ng-container matColumnDef="requestDate">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header> Data Requisitada </th>
                                <td class="table__cell" mat-cell *matCellDef="let element">
                                    {{ element.requestDate | date }} </td>
                            </ng-container>

                            <ng-container matColumnDef="desiredDate">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header> Data Desejada </th>
                                <td class="table__cell" mat-cell *matCellDef="let element">
                                    {{ element.desiredDate | date }} </td>
                            </ng-container>

                            <ng-container matColumnDef="priority">
                                <th class="text-center" mat-header-cell *matHeaderCellDef mat-sort-header> Prioridadade
                                </th>
                                <td class="table__cell text-center" mat-cell *matCellDef="let element">
                                    {{ element.priority }} </td>
                            </ng-container>

                            <ng-container matColumnDef="status">
                                <th class="text-center" mat-header-cell *matHeaderCellDef mat-sort-header> situação
                                </th>
                                <td class="table__cell text-center" mat-cell *matCellDef="let element">
                                    {{ element.status }} </td>
                            </ng-container>

                            <ng-container matColumnDef="actions">
                                <th class="text-center" mat-header-cell *matHeaderCellDef> Ações </th>
                                <td class="text-center td-actions" mat-cell *matCellDef="let element" title="Visualizar materiais">
                                    <button type="button" rel="tooltip" class="btn btn-info"
                                        (click)="element.isExpanded = !element.isExpanded">
                                        <i class="material-icons">table_view</i>
                                    </button>
                                </td>
                            </ng-container>

                            <ng-container matColumnDef="expandedDetail">
                                <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                                    <div class="row table__cell--details"
                                        [@detailExpand]="element.isExpanded ? 'expanded' : 'collapsed'">
                                        <table class="table-responsive table-full-width">
                                            <thead>
                                                <th>ID</th>
                                                <th>Descricao</th>
                                                <th>Quantidade</th>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let material of element.materials">
                                                    <td>{{ material.id }}</td>
                                                    <td>{{ material.description }}</td>
                                                    <td>{{ material.amount }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </td>
                            </ng-container>

                            <tr class="table__row table__row--head" mat-header-row
                                *matHeaderRowDef="columnsToDisplay;sticky: true"></tr>
                            <tr mat-row *matRowDef="let element; columns: columnsToDisplay;" class="table__row"
                                [class.table__row--expanded]="element.isExpanded"></tr>
                            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="table__row--details">
                            </tr>
                        </mat-table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
